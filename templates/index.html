{% extends "base.html" %}
{% block content %}
<div class="tab">
  <button class="tablinks" onclick="openTab(event, 'all')">View All Movies</button>
  <button class="tablinks" onclick="openTab(event, 'myList')">My List</button>
</div>

<div id="all" class="tabcontent">
  <h3>All Movies</h3>
  <p>Click on a movie to view its details.</p>
  <table class="table table-hover">
    <thead class="table-dark">
      <tr><th>ID</th><th></th><th>Title</th><th>Year</th></tr>
    </thead>
    <tbody>
      {% for m in movies %}
      <tr onclick="location.href='{{ url_for('movie_detail', movie_id=m.id) }}'" style="cursor:pointer">
        <td>{{ m.id }}</td>
        <td><img src="{{ m.poster }}" height="80"></td>
        <td>{{ m.title }}</td>
        <td>{{ m.year }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div id="myList" class="tabcontent" style="display:none">
  <h3>My List</h3>
  {% for m in movies if m.in_my_list %}
    <div class="card mb-2 p-2">
      <h5>{{ m.title }} ({{ m.year }})</h5>
      <a href="{{ url_for('movie_detail', movie_id=m.id) }}">View</a>
    </div>
  {% else %}
    <p>No movies in your list yet.</p>
  {% endfor %}
</div>

<script>
  function openTab(evt, tabName) {
    document.querySelectorAll(".tabcontent").forEach(tc => tc.style.display = "none");
    document.querySelectorAll(".tablinks").forEach(tl => tl.classList.remove("active"));
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.classList.add("active");
  }
</script>
{% endblock %}
